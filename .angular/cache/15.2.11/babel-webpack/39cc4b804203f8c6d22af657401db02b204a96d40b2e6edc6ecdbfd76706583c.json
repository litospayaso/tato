{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@ionic/angular\";\nimport * as i3 from \"@pipes/translate.pipe\";\nfunction MovesTableComponent_ion_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 4);\n    i0.ɵɵlistener(\"click\", function MovesTableComponent_ion_button_1_Template_ion_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.resign());\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, i0.ɵɵpipeBind1(3, 3, \"resign\")));\n  }\n}\nfunction MovesTableComponent_div_2_tr_5_td_3_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 8);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const move_r9 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(move_r9 + \" \");\n  }\n}\nfunction MovesTableComponent_div_2_tr_5_td_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 11)(1, \"span\", 8);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, MovesTableComponent_div_2_tr_5_td_3_span_3_Template, 2, 1, \"span\", 7);\n    i0.ɵɵelementStart(4, \"span\", 8);\n    i0.ɵɵtext(5, \"...\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const line_r6 = i0.ɵɵnextContext().$implicit;\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r7.getCurrentMovementNumber());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", line_r6.algebraicMoves);\n  }\n}\nconst _c0 = function (a0, a1) {\n  return {\n    \"advance-w\": a0,\n    \"advance-b\": a1\n  };\n};\nfunction MovesTableComponent_div_2_tr_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\", 8)(1, \"td\", 9);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, MovesTableComponent_div_2_tr_5_td_3_Template, 6, 2, \"td\", 10);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const line_r6 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(3, _c0, line_r6.evaluation >= 0, line_r6.evaluation < 0));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(line_r6.evaluation);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", line_r6.algebraicMoves);\n  }\n}\nfunction MovesTableComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"div\", 6);\n    i0.ɵɵtext(2, \"Stockfish\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"table\")(4, \"tbody\");\n    i0.ɵɵtemplate(5, MovesTableComponent_div_2_tr_5_Template, 4, 6, \"tr\", 7);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.lines);\n  }\n}\nfunction MovesTableComponent_div_3_tr_7_td_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const move_r13 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", move_r13, \" \");\n  }\n}\nfunction MovesTableComponent_div_3_tr_7_td_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r14 = i0.ɵɵnextContext().index;\n    const ctx_r16 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r16.moves[i_r14 + 1] ? ctx_r16.moves[i_r14 + 1] : \"\", \" \");\n  }\n}\nfunction MovesTableComponent_div_3_tr_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\", 14);\n    i0.ɵɵtemplate(1, MovesTableComponent_div_3_tr_7_td_1_Template, 2, 1, \"td\", 15);\n    i0.ɵɵtemplate(2, MovesTableComponent_div_3_tr_7_td_2_Template, 2, 1, \"td\", 15);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r14 = ctx.index;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", i_r14 % 2 === 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", i_r14 % 2 === 0);\n  }\n}\nfunction MovesTableComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"div\", 6);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"table\")(6, \"tbody\");\n    i0.ɵɵtemplate(7, MovesTableComponent_div_3_tr_7_Template, 3, 2, \"tr\", 13);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 2, i0.ɵɵpipeBind1(4, 4, \"moves\")));\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.moves);\n  }\n}\nexport let MovesTableComponent = /*#__PURE__*/(() => {\n  class MovesTableComponent {\n    constructor() {\n      this.resignButton = false;\n      this.resingEmitter = new EventEmitter();\n    }\n    resign() {\n      this.resingEmitter.emit();\n    }\n    ngOnChanges(changes) {\n      if (changes.lines) {\n        clearTimeout(this.updateTimer);\n        this.updateTimer = setTimeout(() => {\n          this.updateLines();\n        }, 800);\n      }\n    }\n    updateLines() {\n      this.lines.forEach(line => {\n        const game = new Chess();\n        game.load_pgn(this.game.history().concat(line.moves).join(' '), {\n          sloppy: true\n        });\n        line.algebraicMoves = game.history().slice(this.game.history().length);\n      });\n      if (this.game.turn() === 'b') {\n        this.lines = this.lines.sort((a, b) => a.evaluation - b.evaluation);\n      }\n    }\n    getSloppyHistory() {\n      return this.game.history({\n        verbose: true\n      }).map(e => `${e.from}${e.to}${e.promotion ? e.promotion : ''}`);\n    }\n    getCurrentMovementNumber() {\n      const movements = this.game.history().length;\n      return (movements / 2 + 1) % 1 ? `${Math.trunc(movements / 2 + 1)}...` : `${Math.trunc(movements / 2 + 1)}.`;\n    }\n    static #_ = this.ɵfac = function MovesTableComponent_Factory(t) {\n      return new (t || MovesTableComponent)();\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: MovesTableComponent,\n      selectors: [[\"app-moves-table\"]],\n      inputs: {\n        moves: \"moves\",\n        lines: \"lines\",\n        game: \"game\",\n        savedGame: \"savedGame\",\n        resignButton: \"resignButton\"\n      },\n      outputs: {\n        resingEmitter: \"resingEmitter\"\n      },\n      features: [i0.ɵɵNgOnChangesFeature],\n      decls: 4,\n      vars: 3,\n      consts: [[1, \"table-component-container\"], [\"expand\", \"full\", \"color\", \"medium\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"table-lines-container table-container\", 4, \"ngIf\"], [\"class\", \"table-container\", 4, \"ngIf\"], [\"expand\", \"full\", \"color\", \"medium\", 3, \"click\"], [1, \"table-lines-container\", \"table-container\"], [1, \"table-title\"], [\"class\", \"line-element\", 4, \"ngFor\", \"ngForOf\"], [1, \"line-element\"], [1, \"evaluation-element\", 3, \"ngClass\"], [\"class\", \"moves-line-element\", 4, \"ngIf\"], [1, \"moves-line-element\"], [1, \"table-container\"], [\"class\", \"move-element\", 4, \"ngFor\", \"ngForOf\"], [1, \"move-element\"], [4, \"ngIf\"]],\n      template: function MovesTableComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0);\n          i0.ɵɵtemplate(1, MovesTableComponent_ion_button_1_Template, 4, 5, \"ion-button\", 1);\n          i0.ɵɵtemplate(2, MovesTableComponent_div_2_Template, 6, 1, \"div\", 2);\n          i0.ɵɵtemplate(3, MovesTableComponent_div_3_Template, 8, 6, \"div\", 3);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.resignButton);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.lines && ctx.lines.length > 0);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.moves && ctx.moves.length > 0);\n        }\n      },\n      dependencies: [i1.NgClass, i1.NgForOf, i1.NgIf, i2.IonButton, i1.AsyncPipe, i3.TranslatePipe],\n      styles: [\".table-component-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.table-component-container[_ngcontent-%COMP%]   .table-lines-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;margin-bottom:8px}.table-component-container[_ngcontent-%COMP%]   .table-lines-container[_ngcontent-%COMP%]   .evaluation-element[_ngcontent-%COMP%]{display:flex;text-align:center;flex-direction:row;width:48px;justify-content:center;align-items:center;width:50px!important}.table-component-container[_ngcontent-%COMP%]   .table-lines-container[_ngcontent-%COMP%]   .evaluation-element.advance-w[_ngcontent-%COMP%]{background-color:#f4f5f8!important;color:#000}.table-component-container[_ngcontent-%COMP%]   .table-lines-container[_ngcontent-%COMP%]   .evaluation-element.advance-b[_ngcontent-%COMP%]{color:#fff;background-color:#5d5d5d!important}.table-component-container[_ngcontent-%COMP%]   .table-lines-container[_ngcontent-%COMP%]   .evaluation-element[_ngcontent-%COMP%]   span.line-element[_ngcontent-%COMP%]{white-space:nowrap}.table-component-container[_ngcontent-%COMP%]   .table-lines-container[_ngcontent-%COMP%]   .evaluation-element[_ngcontent-%COMP%]   span.line-element[_ngcontent-%COMP%]:after{content:\\\",\\\"}.table-component-container[_ngcontent-%COMP%]   .table-lines-container[_ngcontent-%COMP%]   .evaluation-element[_ngcontent-%COMP%]   .moves-line-element[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%!important}.table-component-container[_ngcontent-%COMP%]   .table-lines-container[_ngcontent-%COMP%]   .evaluation-element[_ngcontent-%COMP%]   .moves-line-element[_ngcontent-%COMP%]   .line-element[_ngcontent-%COMP%]{display:flex;flex-direction:row;padding:2px}.table-component-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{width:100%;border:2px solid #dfdfdf;border-top-color:gray;border-left-color:gray;background-color:silver}.table-component-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]{background-color:navy;color:#fff;font-weight:700;padding:2px 4px;font-size:12px}.table-component-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:1px}.table-component-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even)   td[_ngcontent-%COMP%], .table-component-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(4n-7)   td[_ngcontent-%COMP%]{background-color:#f0f0f0}.table-component-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-component-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#fff;padding:2px 4px;font-size:12px;width:50%}.table-component-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.moves-line-element[_ngcontent-%COMP%]{width:100%}\"]\n    });\n  }\n  return MovesTableComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}